<!DOCTYPE html>
<html lang="en"> <head>
<meta charset="utf-8">
<title>D3 Page Template</title>
<script type="text/javascript" src="d3/d3.v3.js"></script>
<style type="text/css">
	.axis path,
	.axis line {
		fill: none;
		stroke: blue;
		shape-rendering: crispEdges;
	}
	.axis text {
		font-family: sans-serif;
		fill: blue;
		font-size: 11px;
	}
</style>
        </head>
        <body>
        	<p>Click on this text to update the chart</p>
			<script type="text/javascript">
				
				w = 600, h = 250, padding = 20;
				var dataset = [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13,
								11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];
				var xScale = d3.scale.ordinal()
							         .domain(d3.range(dataset.length))
							         .rangeRoundBands([padding, w - padding], 0.05);
				var yScale = d3.scale.linear()
							         .domain([ 0,
							         		   d3.max(dataset)])
							         .range([ padding, h - padding ]);				
				var xAxis = d3.svg.axis()
								  .scale( xScale )
								  .orient("bottom")
								  .ticks( 10 );
				var yAxis = d3.svg.axis()
								  .scale( yScale )
								  .orient("left");
				var svg = d3.select("body")
							 .append("svg")
							 .attr("width", w)
							 .attr("height", h);
				svg.selectAll("rect")
			   	   .data(dataset)
				   .enter()
				   .append("rect")
				   .transition()
				   .delay(function(d, i){
				   		return i * 100;
			   		})
				   .duration(500)
				   .attr("x", function(d, i){
				   		return xScale(i)
				   })
				   .attr("y", function( d ){
			   			return h - yScale( d ) + padding ;
				   })
				   .attr("width", xScale.rangeBand())
				   .attr("height", function(d){
				   		return  yScale( d );
				   })
			   	   .attr("fill", function( d ){
			   			return "rgb(50, 200, " + (d * 10) + ")";
				   });
				svg.selectAll("text")
				   .data(dataset)
				   .enter()
				   .append("text")
				   .transition()
					   .delay(function(d, i){
					   		return i * 100;
				   		})
			   	   .text(function(d){
			   			return d;
				   })
				   .attr("x", function(d, i){
				   		return xScale( i ) + xScale.rangeBand()/2;
				   })
				   .attr("y", function( d ){
			   			return h - yScale( d ) + padding  - 2;
				   })
				   .attr("text-anchor", "middle")
				   .attr("fill", "red");

				svg.append("g")
				   .attr("class", "x axis")
				   .attr("transform", "translate(0, " + (h  ) + ")")
				   .call(xAxis);


				d3.select("p")
				  .on("click", function(){
				  	dataset = [];
				  	for(var i = 0; i < 20; i++ ){
				  		var newNumber = Math.floor(Math.random()*25 );
				  		dataset.push( newNumber );
				  	}
					svg.selectAll("rect")
				   	   .data(dataset)
					   //.enter()
					   //.append("rect")
					   .transition()
					   .delay(function(d, i){
					   		return i * 100;
				   		})
					   .duration(500)
					   .attr("x", function(d, i){
					   		return xScale(i)
					   })
					   .attr("y", function( d ){
			   			return h - yScale( d ) + padding ;
				   	   })
					   .attr("width", xScale.rangeBand())
					   .attr("height", function(d){
					   		return  yScale( d );
					   })
				   	   .attr("fill", function( d ){
			   			return "rgb(50, 200, " + (d * 10) + ")";
				   		});
					svg.selectAll("text")
					   .data(dataset)
					   //.enter()
					   //.append("text")
					   .transition()
					   .delay(function(d, i){
					   		return i * 100;
				   		})
				   	   .text(function(d){
				   			return d;
					   })
					   .attr("x", function(d, i){
					   		return xScale( i ) + xScale.rangeBand()/2;
					   })
					   .attr("y", function( d ){
			   			return h - yScale( d ) + padding - 2;
				        })
					   .attr("text-anchor", "middle")
					   .attr("fill", "red");

				  });


            </script>
        </body>
</html>
